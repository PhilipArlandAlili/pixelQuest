<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pixel Quest RPG - My Hero</title>
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <style>
        body {
            background: url('assets/img/character-bg.jpg') top center no-repeat;
            background-size: cover;
            background-attachment: fixed;
        }
    </style>
</head>

<body>
    <section id="myHero" class="px-5 py-5">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center px-4 py-2 mb-3 shadow-lg">
                <a href="index.html" class="btn btn-outline-warning fw-bold px-3">
                    <i class="bi bi-arrow-left me-1"></i> Back
                </a>

                <h2 class="text-center fw-bold m-0 text-warning">
                    <i class="bi bi-shield me-2"></i>My Hero<i class="bi bi-shield ms-2"></i>
                </h2>

                <a href="#store" class="btn btn-warning fw-bold px-3">
                    <i class="bi bi-gem ms-1"></i> Store
                </a>
            </div>

            <div class="row g-3 bg-warning bg-opacity-10 rounded mt-4">
                <div class="col-md-4">
                    <div class="text-center p-3">
                        <img id="hero-img" src="" alt="Hero" class="img-fluid" />
                        <h3 id="hero-name" class="mb-3 text-warning"></h3>

                        <ul class="list-unstyled mb-0 px-3">
                            <li class="d-flex justify-content-between py-1 px-2 border-bottom border-secondary">
                                <span class="fw-bold text-warning">Level:</span>
                                <span id="hero-level" class="text-light"></span>
                            </li>
                            <li class="d-flex justify-content-between py-1 px-2 border-bottom border-secondary">
                                <span class="fw-bold text-warning">HP:</span>
                                <span id="hero-hp" class="text-danger fw-bold"></span>
                            </li>
                            <li class="d-flex justify-content-between py-1 px-2 border-bottom border-secondary">
                                <span class="fw-bold text-warning">Attack:</span>
                                <span id="hero-attack" class="text-light"></span>
                            </li>
                            <li class="d-flex justify-content-between py-1 px-2 border-bottom border-secondary">
                                <span class="fw-bold text-warning">Defense:</span>
                                <span id="hero-defense" class="text-light"></span>
                            </li>
                            <li class="d-flex justify-content-between py-1 px-2 border-bottom border-secondary">
                                <span class="fw-bold text-warning">Speed:</span>
                                <span id="hero-speed" class="text-light"></span>
                            </li>
                            <li class="d-flex justify-content-between py-1 bg-warning px-2">
                                <span class="fw-bold text-dark">Gold:</span>
                                <div class="gold">
                                    <i class="bi-coin fw-bold"></i>
                                    <span id="hero-gold" class="text-dark fw-bold"></span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="text-center p-3">
                        <h3 class="mb-3 text-warning">Inventory</h3>
                        <div class="container">
                            <div class="row g-2" id="inventory">
                                <!-- Inventory items will be inserted here -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 my-4">
                    <div class="bg-dark h-100 text-center p-3 m-0 text-light" id="character-tale">
                        <h3 class="mb-3 text-warning" id="tale-title"></h3>
                        <div class="text-start px-2"
                            style="font-family: 'Georgia', serif; font-size: 0.95rem; line-height: 1.6;">
                            <div id="tale-body"></div>
                            <p class="fst-italic text-warning small" id="tale-quote"></p>
                            <hr class="border-warning" />
                            <p class="mb-2"><strong>Current Quest:</strong> <span id="current-quest"></span></p>
                            <hr class="border-warning" />

                            <a href="game.html" class="btn btn-sm btn-warning w-100 fw-bold">
                                <i class="bi bi-lightning-charge-fill me-1"></i> Fight!
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="store" class="px-4 py-5">
        <div class="container">
            <div class="px-4 py-2 mb-4 shadow-lg bg-warning rounded">
                <h2 class="text-center fw-bold text-dark">
                    <i class="bi bi-gem me-2"></i>Welcome to the Store<i class="bi bi-gem ms-2"></i>
                </h2>
            </div>

            <div class="row g-4">
                <!-- Example Item Cards -->
                <div class="col-md-4">
                    <div class="card h-100 bg-success bg-opacity-50 text-light shadow-sm">
                        <img src="assets/img/storch.png" class="card-img-top p-3" alt="Sword of Valor"
                            style="height: 180px; object-fit: contain;" />
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">Sword of Valor</h5>
                            <p class="card-text flex-grow-1">A mighty blade that boosts your attack power significantly.
                            </p>
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <span class="fw-bold text-warning"><i class="bi bi-coin"></i> 150 Gold</span>
                                <button class="btn btn-warning btn-sm fw-bold">Buy</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card h-100 bg-success bg-opacity-50 text-light shadow-sm">
                        <img src="assets/img/storch.png" class="card-img-top p-3" alt="Steel Armor"
                            style="height: 180px; object-fit: contain;" />
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">Steel Armor</h5>
                            <p class="card-text flex-grow-1">Durable and sturdy steel armor that provides excellent
                                physical defense against attacks.</p>
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <span class="fw-bold text-warning"><i class="bi bi-coin"></i> 250 Gold</span>
                                <button class="btn btn-warning btn-sm fw-bold">Buy</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card h-100 bg-success bg-opacity-50 text-light shadow-sm">
                        <img src="assets/img/storch.png" class="card-img-top p-3" alt="Health Potion"
                            style="height: 180px; object-fit: contain;" />
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">Health Potion</h5>
                            <p class="card-text flex-grow-1">Restores 50 HP instantly when consumed.</p>
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <span class="fw-bold text-warning"><i class="bi bi-coin"></i> 50 Gold</span>
                                <button class="btn btn-warning btn-sm fw-bold">Buy</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Updated quest chain with structured data
        const questChain = [
            { key: 'slime', target: 3, description: 'Defeat Slimes', reward: 25 },
            { key: 'wolf', target: 5, description: 'Defeat Wolves', reward: 50 },
            { key: 'jessica', target: 1, description: 'Defeat Jessica', reward: 100 },
            { key: 'dragon', target: 1, description: 'Defeat Dragon', reward: 150 }
        ];

        const heroTales = {
            warrior: {
                img: 'assets/img/warrior.gif',
                taleTitle: "Warrior's Tale",
                taleText: [
                    "A fearless warrior from the northern lands.",
                    "Famed for unmatched strength and courage in battle.",
                    "He defends the weak and fights for honor."
                ],
                quote: '"Strength and honor guide my blade."',
                questChain: questChain
            },
            wizard: {
                img: 'assets/img/wizard.gif',
                taleTitle: "Wizard's Tale",
                taleText: [
                    "A wise wizard mastering arcane forces.",
                    "Commands elemental magic to vanquish foes.",
                    "Seeks knowledge and balance in the world."
                ],
                quote: '"Magic flows where the mind leads."',
                questChain: questChain
            },
            slime: {
                img: 'assets/img/slime.gif',
                taleTitle: "Slime's Tale",
                taleText: [
                    "A quick and agile slime creature.",
                    "Master of evasion and ranged combat.",
                    "Surprises enemies with unexpected tactics."
                ],
                quote: '"Small but deadly."',
                questChain: questChain
            }
        };

        // Helper: Return quest text with remaining count or completed message
        function getQuestText(quest, playerData) {
            const kills = playerData.kills?.[quest.key] || 0;
            const remaining = Math.max(quest.target - kills, 0);

            if (remaining === 0) return `${quest.description} (Completed!)`;
            return `Defeat ${remaining} ${quest.key}${remaining > 1 ? 's' : ''}`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Load player data
            const playerData = JSON.parse(localStorage.getItem('player'));

            if (!playerData) {
                alert("No hero selected! Redirecting to hero selection.");
                window.location.href = "index.html";
                return;
            }

            // Initialize kills if missing
            playerData.kills = playerData.kills || {
                slime: 0,
                wolf: 0,
                jessica: 0,
                dragon: 0
            };

            // Initialize current quest index if missing
            playerData.currentQuestIndex = playerData.currentQuestIndex ?? 0;

            const char = heroTales[playerData.character] || heroTales.warrior;

            // Update hero info in DOM
            document.getElementById('hero-img').src = char.img;
            document.getElementById('hero-img').alt = playerData.character;
            document.getElementById('hero-name').textContent = playerData.character.charAt(0).toUpperCase() + playerData.character.slice(1);
            document.getElementById('hero-level').textContent = playerData.level;
            document.getElementById('hero-hp').textContent = playerData.hp;
            document.getElementById('hero-attack').textContent = playerData.attack;
            document.getElementById('hero-defense').textContent = playerData.defense;
            document.getElementById('hero-speed').textContent = playerData.speed;
            document.getElementById('hero-gold').textContent = playerData.gold;

            // Update tale text
            document.getElementById('tale-title').textContent = char.taleTitle;
            const taleBody = document.getElementById('tale-body');
            taleBody.innerHTML = '';
            char.taleText.forEach(paragraph => {
                const p = document.createElement('p');
                p.textContent = paragraph;
                taleBody.appendChild(p);
            });

            document.getElementById('tale-quote').textContent = char.quote;

            // Show current quest text with progress
            const currentQuest = questChain[playerData.currentQuestIndex];
            const questText = currentQuest
                ? getQuestText(currentQuest, playerData)
                : "All quests completed!";

            document.getElementById('current-quest').textContent = questText;

            // Inventory placeholder (optional)
            const inventoryContainer = document.getElementById('inventory');
            if (inventoryContainer) {
                inventoryContainer.innerHTML = ''; // clear existing content
                for (let i = 0; i < 6; i++) {
                    const col = document.createElement('div');
                    col.className = 'col-4';
                    col.innerHTML = `
                <div class="border border-dark rounded d-flex justify-content-center align-items-center bg-warning" style="aspect-ratio: 1 / 1;">
                    <!-- Empty slot placeholder -->
                </div>
                `;
                    inventoryContainer.appendChild(col);
                }
            }

            // Save updated player data just in case
            localStorage.setItem('player', JSON.stringify(playerData));
        });
    </script>



    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

</html>